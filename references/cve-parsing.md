# CVE Info Extraction from Jira Issues

Jira CVE issues have inconsistent formatting. Use these strategies in order to extract the CVE ID and affected package name. Fall through to the next strategy if the current one doesn't match.

## Extracting CVE ID

Pattern: `CVE-YYYY-NNNNN` (case-insensitive)

```
regex: (CVE-\d{4}-\d+)
```

This is usually straightforward - the CVE ID appears in the summary, description, or custom fields.

## Extracting Affected Package

This is the hard part. Try these strategies in order:

### Strategy 1: "Upstream Affected Component" Field

Look for the structured Jira field:

```
regex: upstream.*affected.*component\s*:\s*(\S+)
```

This is the most reliable when present.

### Strategy 2: Summary Line Format

Jira CVE summaries often follow: `CVE-XXXX-NNNNN downstream-component: Package-Name has/is/vulnerable...`

```
regex: summary\s*:\s*CVE-\d+-\d+\s+[\w-]+:\s*([\w][\w.-]*(?:-[\w.]+)*)
```

Must handle hyphenated names like `Python-Multipart`, `aiohttp-cors`. Filter out stop words: `the`, `a`, `an`, `http`, `is`, `vulnerable`.

### Strategy 3: Known Python Package Lookup

Search the description for known Python packages followed by description verbs:

```
Known packages: python-multipart, aiohttp, urllib3, requests, django, flask,
cryptography, pillow, numpy, pandas, jinja2, pyyaml, sqlalchemy, celery,
redis, psycopg2, boto3, paramiko, lxml, multipart, starlette, fastapi,
gunicorn, uvicorn, httpx, certifi, setuptools, pip, wheel, idna,
charset-normalizer
```

Match pattern: `\b<package>\b.*(?:is|has|vulnerable|version|prior)`

### Strategy 4: Description Paragraph Start

Look for package names at the start of description paragraphs:

```
regex: (?:DESCRIPTION\s*[-=]+\s*.*?\n\n|Flaw:\s*\n+)([\w][\w.-]*(?:-[\w.]+)*)\s+(?:is|has|was|are|were|allows?)\b
```

Handles capitalized names like "Python-Multipart is a streaming multipart parser". Filter out: `the`, `a`, `an`, `this`, `it`, `security`, `do`, `not`.

### Strategy 5: "Vulnerable to" Pattern

```
regex: ([\w][\w-]*)\s+(?:is\s+)?vulnerable\s+to
```

Filter out: `the`, `a`, `an`, `http`, `is`, `version`, `prior`.

## Package Name Normalization

After extraction, normalize the package name:

1. Convert to lowercase
2. Replace underscores with hyphens
3. This matches pip's canonical format

## Non-Pip Packages to Reject

These are not pip-installable and require different remediation (base image update, system package update):

```
python, python3, cpython, pypy          # Python runtimes
linux, linux-kernel, kernel              # OS kernel
glibc, libc, openssl-libs               # System libraries
java, openjdk, nodejs, node             # Other runtimes
gcc, binutils, gdb                      # Toolchain
```

If the extracted package is in this list, skip it and note that it needs a different remediation approach.

## Additional Fields to Extract

- **Summary**: First 100 chars from `summary\s*:\s*(.+?)(?:\n|$)`
- **CVSS Score**: From `cvss.*score\s*:\s*([\d.]+)`
- **Severity/Priority**: From `(?:severity|priority)\s*:\s*(\w+)`
